(window.webpackJsonpsuperapp=window.webpackJsonpsuperapp||[]).push([[0],{217:function(e,t,a){e.exports=a(332)},332:function(e,t,a){"use strict";a.r(t);a(218),a(244),a(246),a(247),a(249),a(250),a(251),a(252),a(253),a(254),a(255),a(256),a(258),a(259),a(260),a(261),a(262),a(263),a(264),a(265),a(266),a(267),a(269),a(270),a(271),a(272),a(273),a(274),a(275),a(276),a(277),a(278),a(279),a(280),a(281),a(282),a(283),a(284),a(285),a(286);var n=a(0),r=a.n(n),i=a(48),s=a.n(i),o=a(35),c=a.n(o),l=a(117),d=a.n(l),u=a(157),h=a(60),p=a(172),m=a.n(p),f=a(173),b=a.n(f),v=a(120),g=a.n(v),k=(a(295),a(41)),E=a(65),O=a(52),y=a(53),S=a(57),j=a(54),w=a(19),C=a(58),T=a(93),_=a.n(T),P=a(70),I=a.n(P),A=a(67),M=a.n(A),z=a(56),F=a.n(z),x=a(166),U=a.n(x),D=a(167),N=a.n(D),W=a(64),B=a(168),R=a.n(B),J=a(169),V=a.n(J),L=a(119),G=a.n(L),K=a(94),H=a.n(K),q=a(47),Q=a.n(q),X=a(66),Y=a(95),Z=a.n(Y),$=a(87),ee=a.n($),te=a(158),ae=a.n(te),ne=a(118),re=a.n(ne),ie=a(84),se=a(71),oe=a.n(se),ce=a(92),le=a.n(ce),de=a(32),ue=a.n(de),he=a(28),pe=a.n(he),me=a(7),fe=a(91),be=a.n(fe),ve=a(88),ge=a.n(ve),ke=a(89),Ee=a.n(ke),Oe=(a(321),a(90)),ye=a.n(Oe),Se=a(77),je=a.n(Se),we=a(59),Ce=a.n(we),Te=a(162),_e=a.n(Te),Pe=a(163),Ie=a.n(Pe),Ae=a(161),Me=a.n(Ae),ze=Object(me.u)(),Fe=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(S.a)(this,Object(j.a)(t).call(this,e))).state={activeTab:"info",data:null,allTasksFilter:!0,addingTask:!1,taskTitle:"",taskDescription:"",taskTeamSize:1,refresh:0,isJoined:!1,projectMessages:[],commentMessage:""},a.ShowAddingTask=a.ShowAddingTask.bind(Object(w.a)(a)),a.HideAddingTask=a.HideAddingTask.bind(Object(w.a)(a)),a.onChange=a.onChange.bind(Object(w.a)(a)),a.AddTask=a.AddTask.bind(Object(w.a)(a)),a.NumberToString=a.NumberToString.bind(Object(w.a)(a)),a.JoinEvent=a.JoinEvent.bind(Object(w.a)(a)),a.ChangeTab=a.ChangeTab.bind(Object(w.a)(a)),a.SendEventMessage=a.SendEventMessage.bind(Object(w.a)(a)),a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.FetchEvent()}},{key:"FetchEvent",value:function(){var e=this;pe.a.get("https://hypersasha.club/event",{params:{eventID:this.props.activeProject}}).then((function(t){var a=!1;t.data&&t.data.members.forEach((function(t){a=t.user_id===e.props.userId})),e.setState({data:t.data,isJoined:a})})).catch((function(t){console.log(t),e.setState({data:null})})),pe.a.get("https://hypersasha.club/commentBlock",{params:{parent_id:this.props.activeProject}}).then((function(t){console.log(t),e.setState({projectMessages:t.data.messages})})).catch((function(e){console.error(e)}))}},{key:"ShowAddingTask",value:function(){this.setState({addingTask:!0})}},{key:"HideAddingTask",value:function(){this.setState({addingTask:!1})}},{key:"onChange",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(E.a)({},a,n))}},{key:"NumberToString",value:function(e,t){var a=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:a>1&&a<5?t[1]:1===a?t[0]:t[2]}},{key:"AddTask",value:function(){var e=this,t=this.state,a=t.taskTitle,n=t.taskDescription,r=t.taskTeamSize,i=parseInt(r);a.length>4&&i&&i>0&&(console.log("adding task...."),this.props.onShowScreenSpinner(),pe.a.post("https://hypersasha.club/task",{event_id:this.props.activeProject,title:a,description:n,team_size:i}).then((function(t){200===t.status?(e.setState({taskTitle:"",taskDescription:"",taskTeamSize:1}),e.props.onTaskAdded(),e.FetchEvent()):e.props.onTaskAdded()})).catch((function(t){console.error(t),e.props.onTaskAdded()})))}},{key:"JoinEvent",value:function(e){var t=this;this.props.activeProject&&(this.props.onShowScreenSpinner(),pe.a.post("https://hypersasha.club/join",{event_id:this.props.activeProject,member_id:e}).then((function(e){200===e.status&&(t.props.onTaskAdded("\u0412\u044b \u043f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u043b\u0438\u0441\u044c \u043a \u0441\u043e\u0431\u044b\u0442\u0438\u044e."),t.setState({isJoined:!0}),t.FetchEvent())})).catch((function(e){console.error(e),t.props.collapsePopout()})))}},{key:"ChangeTab",value:function(e){this.setState({activeTab:e})}},{key:"SendEventMessage",value:function(){var e=this;console.log(this.props.userId+" - "+this.props.activeProject+" - "+this.state.commentMessage),pe.a.post("https://hypersasha.club/commentBlock/sendMessage",{user_id:this.props.userId,parent_id:this.props.activeProject,text:this.state.commentMessage}).then((function(t){console.log(t),e.FetchEvent(),e.setState({commentMessage:""})})).catch((function(e){console.error(e)}))}},{key:"render",value:function(){var e,t,a,n=this,i=this.state,s=i.data,o=i.addingTask,l=i.taskTitle,d=i.taskDescription,u=i.taskTeamSize,h=i.isJoined,p=(Object(k.a)(i,["data","addingTask","taskTitle","taskDescription","taskTeamSize","isJoined"]),this.props),m=p.id,f=p.goBack,b=p.userId,v=p.openTask;Object(k.a)(p,["id","goBack","userId","openTask"]);s&&(e=s.tasks.map((function(e){return r.a.createElement(me.c,{key:1009090*Math.random(),onClick:function(){v(e)},description:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f "+e.team_size+" "+n.NumberToString(e.team_size,["\u0447\u0435\u043b\u043e\u0432\u0435\u043a","\u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430","\u0447\u0435\u043b\u043e\u0432\u0435\u043a"]),before:r.a.createElement(ye.a,{fill:e.status?"var(--dynamic_green)":""}),expandable:!0},e.title)})),t=s.members.map((function(e){return r.a.createElement(me.c,{key:e.user_id,before:r.a.createElement(Ce.a,{size:48,src:e.photo})},e.first_name+" "+e.last_name)})));var g=0;s&&(a=s.rewards.map((function(e){return g+=e.count,r.a.createElement(me.c,{key:e._id,description:e.donator,asideContent:r.a.createElement(me.e,{type:"secondary"},e.count),before:r.a.createElement(Ce.a,{size:72,type:"app",src:e.photo})},e.title)})));var E=this.state.projectMessages.map((function(e){return r.a.createElement(me.c,{key:e.user_id+"-"+1e6*Math.random(),size:"l",multiline:!0,bottomContent:r.a.createElement("p",{style:{fontWeight:400}},e.text),before:r.a.createElement(Ce.a,{size:48,src:e.photo})},e.first_name+" "+e.last_name)}));return r.a.createElement(M.a,{id:m},r.a.createElement(F.a,{noShadow:!0,left:r.a.createElement(be.a,{onClick:function(){f("feed-list")}},ze===me.j?r.a.createElement(ge.a,null):r.a.createElement(Ee.a,null))},"\u041e \u043f\u0440\u043e\u0435\u043a\u0442\u0435"),r.a.createElement(me.f,{vertical:"top"},r.a.createElement(me.r,{theme:"header",type:"buttons"},r.a.createElement(me.i,null,r.a.createElement(me.s,{selected:"info"===this.state.activeTab,onClick:function(){n.ChangeTab("info")}},"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"),r.a.createElement(me.s,{selected:"members"===this.state.activeTab,onClick:function(){n.ChangeTab("members")}},"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438"),r.a.createElement(me.s,{selected:"rewards"===this.state.activeTab,onClick:function(){n.ChangeTab("rewards")}},"\u041f\u043e\u043e\u0449\u0435\u0440\u0435\u043d\u0438\u044f")))),!s&&r.a.createElement(Q.a,{style:{marginTop:10}},r.a.createElement(_e.a,null)),s&&"info"===this.state.activeTab&&r.a.createElement(me.h,{style:{marginTop:44}},r.a.createElement(me.l,null,r.a.createElement(me.c,{before:r.a.createElement(Ce.a,{src:s.author&&s.author.photo,size:64}),size:"l",multiline:!0,description:s.author&&s.author.first_name+" "+s.author.last_name,bottomContent:r.a.createElement("div",{style:{display:"flex"}},h?r.a.createElement(ue.a,{level:"secondary",size:"m",onClick:function(){c.a.send("VKWebAppShare",{link:"https://vk.com/app7150069_28455889"})}},"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"):r.a.createElement(ue.a,{size:"m",onClick:function(){n.JoinEvent(b)}},"\u041f\u0440\u0438\u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c\u0441\u044f"))},s.title))),s&&s.description&&s.description.length>10&&"info"===this.state.activeTab&&r.a.createElement(me.h,null,r.a.createElement(Q.a,null,r.a.createElement(me.k,{title:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"},s.description))),s&&s.author&&s.author.user_id===b&&"info"===this.state.activeTab&&r.a.createElement(me.h,null,o?r.a.createElement(me.d,{level:"danger",onClick:this.HideAddingTask,before:r.a.createElement(je.a,null),align:"center"},"\u041e\u0442\u043c\u0435\u043d\u0430"):r.a.createElement(me.d,{onClick:this.ShowAddingTask,before:r.a.createElement(ee.a,null),align:"center"},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"),o&&r.a.createElement(Ie.a,null,r.a.createElement(oe.a,{type:"text",value:l,onChange:this.onChange,placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \xab\u041d\u0430\u0434\u0443\u0442\u044c \u0448\u0430\u0440\u0438\u043a\u0438\xbb",top:"\u0417\u0430\u0434\u0430\u043d\u0438\u0435",name:"taskTitle"}),r.a.createElement(le.a,{top:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",name:"taskDescription",onChange:this.onChange,value:d,placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \xab\u0428\u0430\u0440\u0438\u043a\u043e\u0432 \u043d\u0435 \u0434\u0430\u043b\u0438, \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u0434\u0430\u043b\u0438, \u0432\u043e\u0442 \u0442\u0430\u043a \u0433\u043b\u0430\u0437\u0430 \u0440\u0430\u0441\u043a\u0440\u044b\u043b\u0438..\xbb."}),r.a.createElement(oe.a,{type:"number",value:u,onChange:this.onChange,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0447\u0438\u0441\u043b\u043e",top:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0441\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u0435\u0439",name:"taskTeamSize"}),r.a.createElement(ue.a,{size:"xl",onClick:this.AddTask},"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"))),s&&e.length>0&&"info"===this.state.activeTab&&r.a.createElement(me.h,null,r.a.createElement(me.r,{type:"buttons"},r.a.createElement(me.i,null,r.a.createElement(me.s,{selected:this.state.allTasksFilter},"\u0412\u0441\u0435 \u0437\u0430\u0434\u0430\u0447\u0438"),r.a.createElement(me.s,{selected:!this.state.allTasksFilter},"\u041d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435"))),r.a.createElement(me.l,null,e)),s&&E.length>0&&"info"===this.state.activeTab&&r.a.createElement(me.h,{title:"\u041d\u043e\u0432\u043e\u0441\u0442\u0438 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0442\u043e\u0440\u0430"},r.a.createElement(me.l,null,r.a.createElement(me.c,{asideContent:r.a.createElement(ue.a,{onClick:this.SendEventMessage},r.a.createElement(Me.a,null))},r.a.createElement(oe.a,{placeholder:"\u0427\u0442\u043e \u043d\u043e\u0432\u043e\u0433\u043e?",value:this.state.commentMessage,onChange:this.onChange,name:"commentMessage"})),E)),s&&s.members&&"members"===this.state.activeTab&&r.a.createElement("div",null,r.a.createElement(me.h,{style:{marginTop:46}},r.a.createElement(me.l,null,t)),r.a.createElement(me.g,null,t.length+" "+this.NumberToString(t.length,["\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"]))),s&&"rewards"===this.state.activeTab&&r.a.createElement("div",null,r.a.createElement(me.h,{style:{marginTop:46}},a.length>0&&r.a.createElement(me.l,null,a),a.length<=0&&r.a.createElement(Q.a,null,r.a.createElement(me.g,null,"\u041f\u043e\u043e\u0449\u0435\u0440\u0435\u043d\u0438\u0439 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e."))),g>0&&r.a.createElement(me.g,null,"\u0412\u0441\u0435\u0433\u043e "+g+" "+this.NumberToString(g,["\u043f\u043e\u0434\u0430\u0440\u043e\u043a","\u043f\u043e\u0434\u0430\u0440\u043a\u0430","\u043f\u043e\u0434\u0430\u0440\u043a\u043e\u0432"]))))}}]),t}(n.Component),xe=a(165),Ue=a.n(xe),De=a(174),Ne=a(164),We=a.n(Ne);a(325);function Be(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Be(a,!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Be(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Je=Object(me.u)(),Ve=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(S.a)(this,Object(j.a)(t).call(this,e))).state={isOwner:!1,taskInfo:null},a.NumberToString=a.NumberToString.bind(Object(w.a)(a)),a.JoinTask=a.JoinTask.bind(Object(w.a)(a)),a.FinishTask=a.FinishTask.bind(Object(w.a)(a)),a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"NumberToString",value:function(e,t){var a=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:a>1&&a<5?t[1]:1===a?t[0]:t[2]}},{key:"componentDidMount",value:function(){var e=this;this.setState({taskInfo:this.props.taskInfo}),pe.a.get("https://hypersasha.club/event",{params:{eventID:this.props.activeProject}}).then((function(t){if(t&&t.data&&t.data.author){var a=!1;e.props.taskInfo&&e.props.taskInfo&&e.props.taskInfo.team&&e.props.taskInfo.team.map((function(t){t.user_id===e.props.userId&&(a=!0)})),e.setState({isOwner:t.data.author.user_id===e.props.userId,isMember:a})}})).catch((function(e){console.log(e)}))}},{key:"JoinTask",value:function(e){var t=this,a=this.props,n=a.activeProject,r=a.userId;Object(k.a)(a,["activeProject","userId"]);n&&(console.log("joining task...."+e+", "+n,NaN+r),this.props.onShowScreenSpinner(),pe.a.post("https://hypersasha.club/task/request/join",{event_id:n,task_id:e,user_id:r||1}).then((function(e){console.log(e),t.setState((function(e){return{isMember:!0,taskInfo:Re({},e.taskInfo,{team:[].concat(Object(De.a)(e.taskInfo.team),[{user_id:t.props.fetchedUser.id,first_name:t.props.fetchedUser.first_name,last_name:t.props.fetchedUser.last_name,photo:t.props.fetchedUser.photo_200}])})}})),t.props.onTaskAdded("\u0412\u044b \u043e\u0442\u043a\u043b\u0438\u043a\u043d\u0443\u043b\u0438\u0441\u044c \u043d\u0430 \u0437\u0430\u0434\u0430\u0447\u0443.")})).catch((function(e){console.error(e),t.props.collapsePopout()})))}},{key:"FinishTask",value:function(e){var t=this,a=this.props,n=a.activeProject,r=a.onShowScreenSpinner,i=a.onTaskAdded;Object(k.a)(a,["activeProject","onShowScreenSpinner","onTaskAdded"]);r(),n&&pe.a.post("https://hypersasha.club/task/status",{event_id:n,task_id:e,task_status:!0}).then((function(e){200===e.status&&(i("\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e."),t.setState((function(e){return{taskInfo:Re({},e.taskInfo,{status:!0})}})))})).catch((function(e){console.error(e)}))}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.id,i=a.goBack,s=a.activeProject,o=(Object(k.a)(a,["id","goBack","activeProject"]),this.state),c=o.taskInfo;Object(k.a)(o,["taskInfo"]);return c&&c.team&&(e=c.team.map((function(e){return r.a.createElement(me.c,{key:e.user_id,asideContent:t.state.isOwner&&r.a.createElement(ue.a,{level:"secondary",onClick:function(){t.props.ShowRewardModal(e.photo,e.user_id,s)}},r.a.createElement(We.a,null)),before:r.a.createElement(me.b,{size:48,src:e.photo})},e.first_name+" "+e.last_name)}))),r.a.createElement(me.o,{id:n},r.a.createElement(me.p,{noShadow:!0,left:r.a.createElement(be.a,{onClick:function(){i("project")}},Je===me.j?r.a.createElement(ge.a,null):r.a.createElement(Ee.a,null))},"\u0417\u0430\u0434\u0430\u0447\u0430"),c&&r.a.createElement(me.h,null,r.a.createElement(me.l,null,r.a.createElement(me.c,{key:1009090*Math.random(),multiline:!0,size:"l",bottomContent:r.a.createElement("div",{style:{display:"flex"}},!this.state.isOwner&&!c.status&&!this.state.isMember&&r.a.createElement(ue.a,{size:"m",onClick:function(){t.JoinTask(c.id)}},"\u041e\u0442\u043a\u043b\u0438\u043a\u043d\u0443\u0442\u044c\u0441\u044f"),this.state.isOwner&&!c.status&&r.a.createElement(ue.a,{size:"m",onClick:function(){t.FinishTask(c.id)}},"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c"),!this.state.isOwner&&!c.status&&this.state.isMember&&r.a.createElement(ue.a,{size:"m",level:"secondary",disabled:!0},"\u0412\u044b \u043e\u0442\u043a\u043b\u0438\u043a\u043d\u0443\u043b\u0438\u0441\u044c"),c.status&&r.a.createElement(ue.a,{size:"m",level:"secondary",disabled:!0},"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e")),description:c.team_size+" "+this.NumberToString(c.team_size,["\u0447\u0435\u043b\u043e\u0432\u0435\u043a","\u0447\u0435\u043b\u043e\u0432\u0435\u043a\u0430","\u0447\u0435\u043b\u043e\u0432\u0435\u043a"]),before:r.a.createElement(ye.a,{fill:c.status?"var(--dynamic_green)":""})},c.title))),c&&c.description&&r.a.createElement(me.h,null,r.a.createElement(Q.a,null,r.a.createElement(me.k,{title:"\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u0430\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f"},c.description))),c&&r.a.createElement("div",null,r.a.createElement(me.h,{title:"\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0438",description:e.length<=0?"\u041d\u0430 \u044d\u0442\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u043f\u043e\u043a\u0430 \u0447\u0442\u043e \u043d\u0438\u043a\u0442\u043e \u043d\u0435 \u043e\u0442\u043a\u043b\u0438\u043a\u043d\u0443\u043b\u0441\u044f.":" "},r.a.createElement(me.l,null,e)),r.a.createElement(me.g,null,e.length+" "+this.NumberToString(e.length,["\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u0430","\u0443\u0447\u0430\u0441\u0442\u043d\u0438\u043a\u043e\u0432"]))),this.props.snackbar)}}]),t}(n.Component),Le=a(69),Ge=a.n(Le);a(326);function Ke(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function He(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ke(a,!0).forEach((function(t){Object(E.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ke(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var qe=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(S.a)(this,Object(j.a)(t).call(this,e))).state={activeView:"feed",activePanel:"feed-list",filterContextOpened:!1,title:"",description:"",fetching:!1,events:[],modal:null,popout:null,activeProject:null,taskInfo:{},activeModal:null,rewardAvatarLink:null,snackbar:null,rewardWinnerId:null,rewardEventId:null},a.OpenCreateWindow=a.OpenCreateWindow.bind(Object(w.a)(a)),a.CloseCreateWindow=a.CloseCreateWindow.bind(Object(w.a)(a)),a.ApplyFilter=a.ApplyFilter.bind(Object(w.a)(a)),a.ToggleFilterContext=a.ToggleFilterContext.bind(Object(w.a)(a)),a.UpdateEventsList=a.UpdateEventsList.bind(Object(w.a)(a)),a.ComposeEvent=a.ComposeEvent.bind(Object(w.a)(a)),a.onChange=a.onChange.bind(Object(w.a)(a)),a.OpenProject=a.OpenProject.bind(Object(w.a)(a)),a.GoBack=a.GoBack.bind(Object(w.a)(a)),a.ShowScreenSpinner=a.ShowScreenSpinner.bind(Object(w.a)(a)),a.OnTaskAdded=a.OnTaskAdded.bind(Object(w.a)(a)),a.OpenTask=a.OpenTask.bind(Object(w.a)(a)),a.CollapsePopout=a.CollapsePopout.bind(Object(w.a)(a)),a.ShowRewardModal=a.ShowRewardModal.bind(Object(w.a)(a)),a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.UpdateEventsList()}},{key:"OpenCreateWindow",value:function(){this.props.OnCreateBegins&&this.props.OnCreateBegins(),this.setState({activeView:"create-event"})}},{key:"CloseCreateWindow",value:function(){this.props.OnCreateEnds&&this.props.OnCreateEnds(),this.setState({activeView:"feed"})}},{key:"ApplyFilter",value:function(e){this.ToggleFilterContext(),this.props.OnChangeFilters&&this.props.OnChangeFilters(e)}},{key:"ToggleFilterContext",value:function(){this.setState({filterContextOpened:!this.state.filterContextOpened})}},{key:"UpdateEventsList",value:function(){var e=this;this.setState({fetching:!0},(function(){pe.a.get("https://hypersasha.club/allEvents").then((function(t){console.log(t),200===t.status?t.data&&e.setState({events:t.data,fetching:!1}):e.setState({fetching:!1})})).catch((function(t){console.log(t),e.setState({fetching:!1})}))}))}},{key:"ComposeEvent",value:function(e){var t=this;if(this.state.title&&this.state.title.length>4){var a={author_id:e,title:this.state.title||"\u0411\u043e\u043b\u044c\u0448\u043e\u0439 \u0424\u0438\u043d\u0430\u043b",description:this.state.description||"\u0417\u0430\u0449\u0438\u0442\u0430 \u043b\u0443\u0447\u0448\u0435\u0433\u043e \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u0432\u043e\u043b\u043e\u043d\u0442\u0451\u0440\u0441\u043a\u0438\u0445 \u043c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u043d\u0438\u0439."};pe.a.post("https://hypersasha.club/event",a).then((function(e){t.setState({titleInvalid:!1}),t.CloseCreateWindow(),t.UpdateEventsList(),t.OnTaskAdded("\u041f\u0440\u043e\u0435\u043a\u0442 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0441\u043e\u0437\u0434\u0430\u043d.")})).catch((function(e){console.log(e)}))}else this.setState({titleInvalid:!0})}},{key:"NumberToString",value:function(e,t){var a=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:a>1&&a<5?t[1]:1===a?t[0]:t[2]}},{key:"onChange",value:function(e){var t=e.currentTarget,a=t.name,n=t.value;this.setState(Object(E.a)({},a,n))}},{key:"OpenProject",value:function(e){this.setState({activePanel:"project",activeProject:e})}},{key:"GoBack",value:function(e){this.setState({activePanel:e})}},{key:"ShowScreenSpinner",value:function(){this.setState({popout:r.a.createElement(Ue.a,null)})}},{key:"OnTaskAdded",value:function(e){var t=this;this.setState({popout:r.a.createElement(me.a,{onClose:function(){t.setState({popout:null})}},r.a.createElement("p",null,e||"\u0417\u0430\u0434\u0430\u043d\u0438\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e"))}),setTimeout((function(){t.CollapsePopout()}),1750)}},{key:"ShowSnackBar",value:function(e){var t=this;this.setState({snackbar:r.a.createElement(me.q,{onClose:function(){t.setState({snackbar:null})},before:r.a.createElement(X.a,{size:24,style:{backgroundColor:"var(--dynamic_green)"}},r.a.createElement(Ge.a,{fill:"#fff",width:14,height:14})),layout:"vertical"},e)})}},{key:"CollapsePopout",value:function(){this.setState({popout:null})}},{key:"OpenTask",value:function(e){this.setState({activePanel:"task",taskInfo:e})}},{key:"ShowRewardModal",value:function(e,t,a){this.setState({activeModal:"reward",rewardAvatarLink:e,rewardWinnerId:t,rewardEventId:a})}},{key:"OnGiftSent",value:function(){this.setState({activeModal:null}),console.log("sending gift to "+this.state.rewardWinnerId+" from "+this.state.rewardEventId),pe.a.post("https://hypersasha.club/reward",{event_id:this.state.rewardEventId,winner_id:this.state.rewardWinnerId}).then((function(e){console.log(e)})).catch((function(e){console.error(e)})),this.ShowSnackBar("\u041f\u043e\u0434\u0430\u0440\u043e\u043a \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d.")}},{key:"render",value:function(){var e=this,t={flexShrink:0,width:80,display:"flex",flexDirection:"column",alignItems:"flex-start",fontSize:12},a=this.state,n=a.title,i=a.description,s=a.titleInvalid,o=a.activePanel,c=a.activeProject,l=a.taskInfo,d=this.props,u=d.id,h=d.onlyUserEvents,p=d.fetchedUser,m=(Object(k.a)(d,["id","onlyUserEvents","fetchedUser"]),p?p.id:1),f=this.state.events;h&&p&&f.length>0&&(f=f.filter((function(e){return e.author.user_id===p.id})));var b=f.filter((function(e){var t=!1;return e.members.forEach((function(e){e.user_id===m&&(t=!0)})),t})),v="";f.length>0&&(v=f.map((function(t){return r.a.createElement(H.a,{before:r.a.createElement(X.a,{src:t.author&&t.author.photo}),key:t._id,expandable:!0,onClick:function(){e.OpenProject(t._id)},description:t.description},t.title)})));b.length>0&&b.map((function(e){return r.a.createElement("div",{key:e._id,style:He({},t,{paddingLeft:4})},r.a.createElement(X.a,{type:"app",src:e.author&&e.author.photo,size:98,style:{marginBottom:8}}),r.a.createElement("p",null))}));var g=r.a.createElement(me.n,{activeModal:this.state.activeModal},r.a.createElement(me.m,{id:"reward",title:"\u041e\u043d \u044d\u0442\u043e \u0437\u0430\u0441\u043b\u0443\u0436\u0438\u043b!",icon:r.a.createElement(X.a,{src:this.state.rewardAvatarLink,size:48}),caption:"\u041f\u043e\u043b\u0443\u0447\u0430\u0442\u0435\u043b\u044e \u0431\u0443\u0434\u0435\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0439 \u043f\u043e\u0434\u0430\u0440\u043e\u043a \u0438\u0437 \u0432\u0441\u0435\u0445, \u0447\u0442\u043e \u0438\u043c\u0435\u044e\u0442\u0441\u044f \u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u043c \u043f\u0440\u043e\u0435\u043a\u0442\u0435.",align:"center",actions:[{title:"\u041d\u0430\u0433\u0440\u0430\u0434\u0438\u0442\u044c",type:"primary",action:function(){e.OnGiftSent()}}],onClose:function(){return e.setState({activeModal:null})}},r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(me.t,{count:3,size:"m",photos:["https://adindex.ru/files2/news/2019_07/273815_3.png","https://mesmika.com/upload/000/u28/17/7e/24f7f7c5.jpg","https://dodopizza-a.akamaihd.net/static/Img/Products/Pizza/ru-RU/7d770266-c779-4e9d-b2bf-aa741de13bed.jpg","https://pbs.twimg.com/profile_images/1047134624433000448/yruIOfJT.jpg"]}))));return r.a.createElement(_.a,{id:u,activeView:this.state.activeView},r.a.createElement(I.a,{id:"feed",activePanel:o,modal:g,popout:this.state.popout},r.a.createElement(M.a,{id:"feed-list"},r.a.createElement(F.a,{left:r.a.createElement(W.a,{onClick:this.OpenCreateWindow},r.a.createElement(ee.a,null))},r.a.createElement(U.a,{onClick:this.ToggleFilterContext,aside:r.a.createElement(ae.a,null)},"\u041f\u0440\u043e\u0435\u043a\u0442\u044b")),r.a.createElement(N.a,{opened:this.state.filterContextOpened,onClose:this.ToggleFilterContext},r.a.createElement(G.a,null,r.a.createElement(H.a,{onClick:function(){e.ApplyFilter(!1)},asideContent:!h&&r.a.createElement(re.a,{fill:"var(--accent)"})},"\u0412\u0441\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u044b"),r.a.createElement(H.a,{onClick:function(){e.ApplyFilter(!0)},asideContent:h&&r.a.createElement(re.a,{fill:"var(--accent)"})},"\u0422\u043e\u043b\u044c\u043a\u043e \u043c\u043e\u0438"))),r.a.createElement(R.a,{onRefresh:this.UpdateEventsList,isFetching:this.state.fetching},r.a.createElement(V.a,{style:{marginTop:0}},v.length<=0&&r.a.createElement(Q.a,null,r.a.createElement(Z.a,null,"\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u0441\u043e\u0431\u044b\u0442\u0438\u044f.")),r.a.createElement(G.a,null,v)),r.a.createElement(Z.a,null,v.length," ",this.NumberToString(v.length,["\u0441\u043e\u0431\u044b\u0442\u0438\u0435","\u0441\u043e\u0431\u044b\u0442\u0438\u044f","\u0441\u043e\u0431\u044b\u0442\u0438\u0439"])))),r.a.createElement(Fe,{id:"project",onShowScreenSpinner:this.ShowScreenSpinner,onTaskAdded:this.OnTaskAdded,userId:m,activeProject:c,openTask:this.OpenTask,collapsePopout:this.CollapsePopout,goBack:this.GoBack}),r.a.createElement(Ve,{id:"task",taskInfo:l,userId:m,fetchedUser:p,activeProject:c,collapsePopout:this.CollapsePopout,goBack:this.GoBack,snackbar:this.state.snackbar,ShowRewardModal:this.ShowRewardModal,onTaskAdded:this.OnTaskAdded,onShowScreenSpinner:this.ShowScreenSpinner})),r.a.createElement(I.a,{id:"create-event",activePanel:"base-panel"},r.a.createElement(M.a,{id:"base-panel",theme:"white"},r.a.createElement(F.a,{left:r.a.createElement(W.a,{onClick:this.CloseCreateWindow},"\u041e\u0442\u043c\u0435\u043d\u0430")},"\u041d\u043e\u0432\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442"),r.a.createElement(ie.a,null,r.a.createElement(oe.a,{onChange:this.onChange,type:"text",value:n,status:s?"error":"default",placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0426\u0438\u0444\u0440\u043e\u0432\u043e\u0439 \u043f\u0440\u043e\u0440\u044b\u0432",top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430",bottom:s&&"\u041d\u0435 \u043c\u0435\u043d\u0435\u0435 4 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432.",name:"title"}),r.a.createElement(le.a,{top:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:i,name:"description",onChange:this.onChange,placeholder:"\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \xab\u041a\u0440\u0443\u043f\u043d\u0435\u0439\u0448\u0438\u0439 \u0445\u0430\u043a\u0430\u0442\u043e\u043d \u043f\u043e \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044e \u0432\u043e \u0432\u0441\u0435\u043c \u043c\u0438\u0440\u0435\xbb."}),r.a.createElement(ue.a,{size:"xl",onClick:function(){e.ComposeEvent(m)}},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442")),r.a.createElement(Z.a,null,"\u041f\u043e\u0441\u043b\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0435\u043a\u0442\u0430, \u0412\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u0432 \u043d\u0435\u0433\u043e \u0432\u043e\u043b\u043e\u043d\u0442\u0435\u0440\u043e\u0432, \u043f\u0430\u0440\u0442\u043d\u0435\u0440\u043e\u0432 \u0438 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u0444\u043d\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043d\u0435\u043c."))))}}]),t}(n.Component),Qe=a(170),Xe=a.n(Qe),Ye=a(171),Ze=a.n(Ye),$e=a(85),et=function(e){function t(e){var a;return Object(O.a)(this,t),(a=Object(S.a)(this,Object(j.a)(t).call(this,e))).state={activeView:"rewards-list",collectedRewards:[],isFetching:!0},a.NumberToString=a.NumberToString.bind(Object(w.a)(a)),a}return Object(C.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("Rewards!"),pe.a.post("https://hypersasha.club/getMyRewards",{user_id:this.props.fetchedUser&&this.props.fetchedUser.id?this.props.fetchedUser.id:1}).then((function(t){console.log(t),e.setState({collectedRewards:t.data,isFetching:!1})})).catch((function(e){console.error(e)}))}},{key:"NumberToString",value:function(e,t){var a=(e=Math.abs(e)%100)%10;return e>10&&e<20?t[2]:a>1&&a<5?t[1]:1===a?t[0]:t[2]}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.OnRewardConfirmation,n=e.fetchedUser,i=(Object(k.a)(e,["id","OnRewardConfirmation","fetchedUser"]),this.state.collectedRewards.filter((function(e){return!0===e.verified}))),s=this.state.collectedRewards.filter((function(e){return!1===e.verified})).map((function(e){return r.a.createElement(me.c,{key:e._id,description:e.verified?"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0432\u0440\u0443\u0447\u0435\u043d\u0438\u044f.":"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0440\u0443\u0437\u044c\u044f\u043c \u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0438, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0412\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u043b\u0438 \u0443\u0447\u0430\u0441\u0442\u0438\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0434\u0430\u0440\u043e\u043a.",size:"l",multiline:!0,bottomContent:!e.verified&&r.a.createElement(ue.a,{onClick:function(){a(e.reward_id),console.log("verifiybg reward..."+e.reward_id+" from "+(n&&n.id?n.id:1)),pe.a.post("https://hypersasha.club/reward/verify",{user_id:n&&n.id?n.id:1,reward_id:e.reward_id}).then((function(e){console.log(e)})).catch((function(e){console.error(e)})),c.a.send("VKWebAppShare",{link:"https://vk.com/app7150069_28455889"})}},"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"),before:r.a.createElement(Ce.a,{size:72,type:"app",src:e.reward.photo})},e.reward.title)})),o=i.map((function(e){return r.a.createElement(me.c,{key:e._id,description:e.verified?"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d \u0438 \u043e\u0436\u0438\u0434\u0430\u0435\u0442 \u0432\u0440\u0443\u0447\u0435\u043d\u0438\u044f.":"\u0420\u0430\u0441\u0441\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0440\u0443\u0437\u044c\u044f\u043c \u043e \u0441\u043e\u0431\u044b\u0442\u0438\u0438, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0412\u044b \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u043b\u0438 \u0443\u0447\u0430\u0441\u0442\u0438\u0435, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u0434\u0430\u0440\u043e\u043a.",multiline:!0,bottomContent:!e.verified&&r.a.createElement(ue.a,{onClick:function(){a(e.reward_id),console.log("verifiybg reward..."+e.reward_id),c.a.send("VKWebAppShare",{link:"https://vk.com/app7150069_28455889"})}},"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"),before:r.a.createElement(Ce.a,{size:48,type:"app",src:e.reward.photo})},e.reward.title)}));return r.a.createElement(_.a,{id:t,activeView:this.state.activeView},r.a.createElement(I.a,{id:"rewards-list",activePanel:"all-rewards"},r.a.createElement(M.a,{id:"all-rewards"},r.a.createElement(F.a,null,"\u041c\u043e\u0438 \u043d\u0430\u0433\u0440\u0430\u0434\u044b"),this.state.isFetching&&r.a.createElement($e.a,null),!this.state.isFetching&&r.a.createElement(me.h,{title:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u0435",style:{marginTop:0}},r.a.createElement(me.l,null,o)),!this.state.isFetching&&r.a.createElement(me.g,null,o.length+" "+this.NumberToString(o.length,["\u043d\u0430\u0433\u0440\u0430\u0434\u0430","\u043d\u0430\u0433\u0440\u0430\u0434\u044b","\u043d\u0430\u0433\u0440\u0430\u0434"])),!this.state.isFetching&&r.a.createElement(me.h,{title:"\u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f"},r.a.createElement(me.l,null,s)),!this.state.isFetching&&r.a.createElement(me.g,null,s.length+" "+this.NumberToString(s.length,["\u043d\u0430\u0433\u0440\u0430\u0434\u0430","\u043d\u0430\u0433\u0440\u0430\u0434\u044b","\u043d\u0430\u0433\u0440\u0430\u0434"])))))}}]),t}(n.Component),tt=function(){var e=Object(n.useState)("events"),t=Object(h.a)(e,2),a=t[0],i=t[1],s=Object(n.useState)(!0),o=Object(h.a)(s,2),l=o[0],p=o[1],f=Object(n.useState)(!1),v=Object(h.a)(f,2),k=v[0],E=v[1],O=Object(n.useState)(null),y=Object(h.a)(O,2),S=y[0],j=y[1],w=Object(n.useState)("home"),C=(Object(h.a)(w,1)[0],Object(n.useState)("example")),T=Object(h.a)(C,2),_=(T[0],T[1],Object(n.useState)(null)),P=Object(h.a)(_,2),I=P[0],A=P[1];Object(n.useEffect)((function(){function e(){return(e=Object(u.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.sendPromise("VKWebAppGetUserInfo");case 2:t=e.sent,A(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}c.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var r=document.createAttribute("scheme");r.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(r)}"VKWebAppShareResult"===a&&"message"===n.type&&pe.a.post("https://hypersasha.club/reward/verify",{user_id:I&&I.id?I.id:1,reward_id:S}).then((function(e){console.log(e),200===e.status&&i("events")})).catch((function(e){console.error(e)}))})),function(){e.apply(this,arguments)}()}),[]);var M=function(e){i(e.currentTarget.dataset.story)};return r.a.createElement(m.a,{activeStory:a,tabbar:l?r.a.createElement(b.a,null,r.a.createElement(g.a,{"data-story":"events",onClick:M,text:"\u0421\u043e\u0431\u044b\u0442\u0438\u044f",selected:"events"===a},r.a.createElement(Xe.a,null)),r.a.createElement(g.a,{"data-story":"rewards",onClick:M,text:"\u041d\u0430\u0433\u0440\u0430\u0434\u044b",selected:"rewards"===a},r.a.createElement(Ze.a,null))):""},r.a.createElement(qe,{id:"events",fetchedUser:I,OnChangeFilters:function(e){E(e)},onlyUserEvents:k,OnCreateBegins:function(){p(!1)},OnCreateEnds:function(){p(!0)}}),r.a.createElement(et,{id:"rewards",OnRewardConfirmation:function(e){j(e)},fetchedUser:I}))};c.a.send("VKWebAppInit"),s.a.render(r.a.createElement(tt,null),document.getElementById("root"))}},[[217,1,2]]]);
//# sourceMappingURL=main.c201ac5d.chunk.js.map